<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#0e0f12"/>
  <title>ワイヤー迷宮</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <div id="app" class="app">
    <header class="topbar">
      <div class="brand">
        <div class="brand-title" id="brandTitle">ワイヤー迷宮</div>
        <div class="brand-sub" id="brandSub">PWA / Offline</div>
      </div>
      <div class="topbar-right">
        <button class="btn ghost" id="btnSettings">設定</button>
      </div>
    </header>

    <main class="main">
      <!-- Title -->
      <section class="screen" id="screenTitle">
        <div class="card title-card">
          <div class="title" id="titleText">ワイヤー迷宮</div>
          <div class="subtitle" id="titleDesc">太線ワイヤーフレームの一人称ダンジョン</div>
          <div class="actions">
            <button class="btn primary" id="btnNew">ニューゲーム</button>
            <button class="btn" id="btnContinue">つづきから</button>
          </div>
          <div class="minor">
            <button class="btn ghost danger" id="btnReset">セーブ消去</button>
          </div>
        </div>
      </section>

      <!-- Game -->
      <section class="screen hidden" id="screenGame">
        <div class="hud">
          <div class="hud-left">
            <div class="stat"><span id="lblFloor">階層</span> <span id="hudFloor">-</span></div>
            <div class="stat"><span id="lblHP">HP</span> <span id="hudHP">-</span></div>
            <div class="stat"><span id="lblMP">MP</span> <span id="hudMP">-</span></div>
            <div class="stat"><span id="lblGold">G</span> <span id="hudGold">-</span></div>
          </div>
          <div class="hud-right">
            <div class="stat"><span id="lblWeapon">武器</span></div>
            <select id="weaponSelect" class="select"></select>
            <div class="compass" id="compass">N</div>
          </div>
        </div>

        <div class="view">
          <canvas id="viewCanvas"></canvas>
          <div class="view-overlay" id="viewOverlay"></div>
        </div>

        <div class="controls">
          <div class="row">
            <button class="btn big" id="btnForward">前進</button>
            <button class="btn big" id="btnBack">後退</button>
          </div>
          <div class="row">
            <button class="btn" id="btnMelee">近接</button>
            <button class="btn" id="btnRanged">遠距離</button>
            <button class="btn" id="btnInteract">調べる</button>
            <button class="btn" id="btnItems">アイテム</button>
            <button class="btn ghost" id="btnSave">保存</button>
          </div>
        </div>

        <div class="log">
          <div class="log-title" id="lblLog">ログ</div>
          <div class="log-body" id="logBody"></div>
        </div>
      </section>

      <!-- Result -->
      <section class="screen hidden" id="screenResult">
        <div class="card">
          <div class="title" id="resultTitle">結果</div>
          <div class="result-grid">
            <div><span id="lblResFloor">到達階層</span>: <b id="resFloor">-</b></div>
            <div><span id="lblResTurns">ターン数</span>: <b id="resTurns">-</b></div>
            <div><span id="lblResTime">時間</span>: <b id="resTime">-</b></div>
            <div><span id="lblResGold">所持金</span>: <b id="resGold">-</b></div>
          </div>
          <div class="actions">
            <button class="btn primary" id="btnRetry">もう一度</button>
            <button class="btn" id="btnBackTitle">タイトルへ</button>
          </div>
        </div>
      </section>

      <!-- Modal: Settings -->
      <div class="modal hidden" id="modalSettings" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title" id="settingsTitle">設定</div>
            <button class="btn ghost" id="btnCloseSettings">閉じる</button>
          </div>
          <div class="modal-body">
            <div class="setting-group">
              <div class="setting-label" id="lblLang">言語</div>
              <div class="setting-row">
                <select id="langSelect" class="select">
                  <option value="ja">日本語</option>
                  <option value="en">English</option>
                </select>
              </div>
            </div>

            <div class="setting-group">
              <div class="setting-label" id="lblAudio">音</div>
              <div class="setting-row">
                <label class="toggle">
                  <input type="checkbox" id="toggleBgm" checked>
                  <span id="lblBgm">BGM</span>
                </label>
                <label class="toggle">
                  <input type="checkbox" id="toggleSe" checked>
                  <span id="lblSe">SE</span>
                </label>
              </div>
            </div>

            <div class="setting-group">
              <div class="setting-label" id="lblControls">操作</div>
              <div class="setting-row">
                <label class="toggle">
                  <input type="checkbox" id="toggleInvertSwipe">
                  <span id="lblInvert">スワイプ反転</span>
                </label>
              </div>
              <div class="hint">左右スワイプで方向転換。前進/後退はボタン。壁にぶつかった前進/後退はターン消費しません。</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal: Items -->
      <div class="modal hidden" id="modalItems" role="dialog" aria-modal="true">
        <div class="modal-card">
          <div class="modal-head">
            <div class="modal-title" id="itemsTitle">アイテム</div>
            <button class="btn ghost" id="btnCloseItems">閉じる</button>
          </div>
          <div class="modal-body" id="itemsBody"></div>
        </div>
      </div>

    </main>

    <footer class="footer">
      <div class="footer-left">Swipe to turn • Offline PWA</div>
      <div class="footer-right" id="buildInfo"></div>
    </footer>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
